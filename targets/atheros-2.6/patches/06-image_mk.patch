--- kamikaze-7.09-src/include/image.mk	2007-09-20 04:53:16.000000000 -0400
+++ kamikaze-7.09-gargoyle-src/include/image.mk	2008-11-29 22:01:38.000000000 -0500
@@ -89,6 +89,27 @@
 	find $(BUILD_DIR)/root -type d | $(XARGS) chmod 0755
 	mkdir -p $(BUILD_DIR)/root/tmp
 	chmod 0777 $(BUILD_DIR)/root/tmp
+
+
+	#############################################################################
+	############# CUSTOM GARGOYLE CONFIGURATION #################################
+	#############################################################################
+	# we put custom configuration here because this is the absolute last thing called before we build an image
+	# right now it isn't as important that all configuration be done this late, but putting it here makes sure
+	# no other scripts can be called before images are built, modifying or reversing our changes.
+
+	# remove init scripts of things that should not be active by default
+	IPKG_INSTROOT=$(BUILD_DIR)/root sh $(BUILD_DIR)/root/etc/rc.common $(BUILD_DIR)/root/etc/init.d/httpd disable
+	IPKG_INSTROOT=$(BUILD_DIR)/root sh $(BUILD_DIR)/root/etc/rc.common $(BUILD_DIR)/root/etc/init.d/miniupnpd disable
+	IPKG_INSTROOT=$(BUILD_DIR)/root sh $(BUILD_DIR)/root/etc/rc.common $(BUILD_DIR)/root/etc/init.d/qos_gargoyle disable
+	IPKG_INSTROOT=$(BUILD_DIR)/root sh $(BUILD_DIR)/root/etc/rc.common $(BUILD_DIR)/root/etc/init.d/webmon_gargoyle disable
+
+	# ensure ntpclient is active
+	chmod 700 $(BUILD_DIR)/root/etc/hotplug.d/iface/20-ntpclient
+
+
+	##############################################################################
+
 endef
 
 define Image/mkfs/prepare
